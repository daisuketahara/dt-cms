(function(c){var a;var t;var r;var q;var g;var m;var b;var k;var o;var n;var p;var f=0;var e=1;var s="";var u=0;var l;c.fn.dtTable=function(v){var x=c.extend({functions:true,sorting:true,filter:false,view:true,ajaxUrl:"",addUrl:"",editUrl:"",deleteUrl:"",limit:15},v);t=this;a=j();w=x.filter;l=x.view;b=x.sorting;n=x.functions;p=x.limit;r=x.ajaxUrl;q=x.addUrl;g=x.editUrl;m=x.deleteUrl;this.wrap('<div class="table-responsive"></div>');this.wrap('<form action="" class="im-table-form" method="post"></form>');this.addClass("im-table");if(x.sorting){this.find("thead tr:first-child th").each(function(){c(this).append('<a class="ml-3"><i class="fa fa-sort" aria-hidden="true"></i></a>');c(this).addClass("im-table-sort pointer")})}if(x.functions){this.find("thead tr:first-child").prepend('<th><input type="checkbox"></th>');if(x.addUrl){var y='<a href="'+x.addUrl+'" class="table-add pointer float-right btn btn-success btn-sm"><i class="fa fa-plus"></i></a>'}else{var y=""}this.find("thead tr:first-child").append('<th class="width-200">'+y+"</th>")}if(x.filter){var w='<tr class="im-table-filter">';if(x.functions){w+="<td></td>"}for(i=0;i<a.length;i++){w+='<td><input type="text" name="filter-'+a[i]+'" data-column="'+a[i]+'" placeholder="filter..."></td>'}if(x.functions){w+='<td class="text-right"></td>'}w+="</tr>";this.find("thead").append(w)}h();return this};function h(){var v=[];jQuery(".im-table-filter").find("input").each(function(){v.push(jQuery(this).data("column")+"="+jQuery(this).val())});c.ajax({url:r,type:"POST",data:{limit:p,offset:f,sortColumn:k,sortDirection:o,filter:v.join("&")},dataType:"json",success:function(x){var x=JSON.parse(x);s=x.data;u=x.total;t.find("tbody").remove();t.find("tfoot").remove();var w="<tbody>";for(i=0;i<s.length;i++){w+='<tr id="row-'+s[i]["id"]+'">';if(n){w+='<td><input type="checkbox"></td>'}for(i2=0;i2<a.length;i2++){w+="<td>"+d(s[i][a[i2]])+"</td>"}if(n){w+='<td class="text-right">';if(l){w+='<a class="im-table-view btn btn-secondary btn-sm text-white pointer ml-1" data-id="'+s[i]["id"]+'"><i class="fa fa-search" aria-hidden="true"></i></a>'}if(g!=""){w+='<a href="'+g+s[i]["id"]+'" class="im-table-edit btn btn-secondary btn-sm text-white pointer ml-1"><i class="fa fa-pencil-alt" aria-hidden="true"></i></a>'}if(m!=""){w+='<a class="im-table-delete btn btn-secondary btn-sm text-white pointer ml-1" data-id="'+s[i]["id"]+'"><i class="fa fa-trash" aria-hidden="true"></i></a>'}w+="</td>"}w+="</tr>"}w+="</tbody>";c(".table thead").after(w);var y=t.find("thead tr:first-child th").length;t.find("tbody").after('<tfoot class="text-center"><tr><td colspan="'+y+'"><div class="dt-table-paginator"></div></td></tr></tfoot>');c(".dt-table-paginator").dtPaginator({page:e,lastPage:Math.ceil(u/p),showNext:true,showPrevious:true,showFirst:true,showLast:true,})}})}function j(){var v=[];t.find("thead tr:first-child th").each(function(){v.push(c(this).data("column"))});return v}function d(w){if(w==null){return""}if(w===true){return'<a class="green"><i class="fas fa-check"></i></a>'}if(w===false){return'<a class="red"><i class="fas fa-times"></i></a>'}if(w.timestamp){var x=new Date(w.timestamp*1000);var v={weekday:"long",year:"numeric",month:"long",day:"numeric"};return x.toLocaleDateString("en-US",v)}return w}c(document).on("click",".im-table-sort",function(){var v=jQuery(this).data("sort");t.find("thead tr:first-child .im-table-sort").each(function(){c(this).data("sort","");c(this).find("a").html('<i class="fa fa-sort" aria-hidden="true"></i>')});k=c(this).data("column");if(v=="desc"){jQuery(this).data("sort","asc");c(this).find("a").html('<i class="fa fa-sort-up" aria-hidden="true"></i>');o="asc"}else{jQuery(this).data("sort","desc");c(this).find("a").html('<i class="fa fa-sort-down" aria-hidden="true"></i>');o="desc"}h()});c(document).on("blur",".im-table-filter input",function(){h()});c(document).on("submit",".im-table-form",function(v){v.preventDefault();h()});c(document).on("click",".pagination .page-link",function(){e=jQuery(this).data("page");f=(e-1)*p;h()});c(document).on("click",".im-table-view",function(){var A=c(this).data("id");for(i=0;i<s.length;i++){if(s[i]["id"]==A){var z=s[i];break}}var x="";for(var v in z){var y=v;if(t.find('[data-column="'+v+'"]').length){y=c('[data-column="'+v+'"]').text()}x+='<label class="modal-label">'+y+"</label><br>"+d(z[v])+"<br><br>"}var w="";if(g!=""){w+='<a href="'+g+"/"+s[i]["id"]+'" class="im-table-edit btn btn-secondary btn-sm text-white pointer ml-1"><i class="fa fa-pencil-alt" aria-hidden="true"></i></a>'}if(m!=""){w+='<a class="im-table-delete btn btn-secondary btn-sm text-white pointer ml-1" data-id="'+s[i]["id"]+'"><i class="fa fa-trash" aria-hidden="true"></i></a>'}c("#dt-modal").dtModal({title:translations["View record"]+": "+z.id,content:x,buttons:w,size:"lg"})});c(document).on("click",".im-table-delete",function(){var x=c(this).data("id");var w="<p>"+translations["You are about to delete a record, this cannot be undone."]+"</p>";w+="<p>"+translations["Do you want to proceed?"]+"</p>";var v='<button type="button" class="btn btn-default" data-dismiss="modal">'+translations.Cancel+"</button>";v+='<button type="button" id="confirm-delete" class="btn btn-danger btn-ok" data-url="'+m+'" data-id="'+x+'" data-dismiss="modal">'+translations.Delete+"</button>";c("#dt-modal").dtModal({title:translations["Confirm delete"],content:w,buttons:v})});jQuery(document).on("click","#confirm-delete",function(w){var v=c(this).data("url");var x=c(this).data("id");c.ajax({url:v+"/"+x,type:"POST",dataType:"html",success:function(y){if(y==1){setTimeout(function(){t.find("#row-"+x).css({background:"#d23430"});t.find("#row-"+x+" td").each(function(){c(this).wrapInner('<div class="td_wrapper"></div>')});t.find("#row-"+x+" .td_wrapper").each(function(A,B){c(this).slideUp()});t.find("#row-"+x+" td").animate({"padding-top":"0px","padding-bottom":"0px"},function(){h()})},400)}else{var z='<p class="red">'+translations["An error has occurred."]+"</div>";z+='<p class="red">'+translations["Please try again."]+"</div>";c("#dt-modal").dtModal({title:translations.Error,content:z,})}}})})}(jQuery));
